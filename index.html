<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡éƒ½äº‘å›¾ï¼šå—äº¬ç°å½“ä»£æ–‡å­¦åœ°å›¾æ•°å­—å¯¼è§ˆä¸æ–‡åˆ›å¹³å°</title>
    <link rel="stylesheet" href="./css/style.css">
    <!-- åœ¨index.htmlçš„<head>éƒ¨åˆ†æ·»åŠ  -->
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ“š</text></svg>" type="image/svg+xml">
    <link rel="stylesheet" href="./css/ai_assistant.css"> 
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Noto+Sans+SC:wght@300;500&display=swap" rel="stylesheet">
    <script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.4.2/echarts.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <style>
        :root {
            --primary-color: #1a5fad;
            --secondary-color: #2a8fe6;
            --accent-color: #ff6b6b;
            --dark-text: #2d3748;
            --light-text: #718096;
            --bg-gradient: linear-gradient(135deg, #f8f9fa, #e9ecef);
            --side-panel-bg: rgba(255, 255, 255, 0.9);
            --side-panel-width: 280px;
        }

        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: var(--bg-gradient);
            color: var(--dark-text);
            line-height: 1.6;
            position: relative;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                        url('https://example.com/nanjing-skyline.jpg') center/cover;
            color: white;
            padding: 3rem 1rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header h1 {
            font-family: 'Noto Serif SC', serif;
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            animation: fadeInDown 1s ease;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            animation: fadeIn 1.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInDown {
            from { 
                opacity: 0;
                transform: translateY(-20px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .explore-btn-container {
            position: relative;
            overflow: hidden;
            margin: 3rem 0;
            padding: 4rem 0;
            display: flex;           
            justify-content: center; 
            align-items: center;     
            text-align: center;     
        }
        
        .explore-btn {
            display: inline-block;
            padding: 1rem 2.5rem;
            border-radius: 50px;
            font-weight: bold;
            text-decoration: none;
            box-shadow: 0 10px 20px rgba(42, 143, 230, 0.3);
            position: relative;
            overflow: hidden;
            z-index: 1;
            transition: all 0.4s;
        }
        
        .explore-btn:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            z-index: -1;
            transition: all 0.4s;
        }
        
        .explore-btn:hover:before {
            transform: scale(1.05);
            opacity: 0.8;
        }
        
        .explore-btn:after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%, -50%);
            transform-origin: 50% 50%;
        }
        
        .explore-btn:hover:after {
            animation: ripple 1s ease-out;
        }
        
        @keyframes ripple {
            0% {
                transform: scale(0, 0);
                opacity: 0.5;
            }
            100% {
                transform: scale(20, 20);
                opacity: 0;
            }
        }
        
        .location-detail h3 {
            color: var(--primary-color);
            font-family: 'Noto Serif SC', serif;
            margin-bottom: 0.5rem;
            position: relative;
            padding-bottom: 0.5rem;
        }
        
        .location-detail h3:after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 50px;
            height: 3px;
            background: var(--accent-color);
        }
        
        .author-info {
            background: rgba(255, 255, 255, 0.9);
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .author-info h3 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }
        
        .author-info p {
            color: var(--light-text);
            margin-bottom: 1rem;
        }
        
        .work-title {
            font-weight: bold;
            color: var(--dark-text);
        }
        
        .work-author {
            font-size: 0.9rem;
            color: var(--light-text);
            margin: 0.3rem 0;
        }
        
        .work-excerpt {
            font-size: 0.9rem;
            line-height: 1.5;
            color: #4a5568;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            max-width: 1400px;
            margin: 2rem auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            overflow: hidden;
            background: white;
            position: relative;
            z-index: 1;
        }
        
        #mapContainer {
            height: 600px;
            width: 100%;
            position: relative;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .sidebar {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        #infoPanel {
            flex: 1;
            padding: 1.5rem;
            overflow-y: auto;
            background: white;
            border-right: 1px solid #e2e8f0;
        }
        
        .location-detail, .author-info {
            animation: fadeIn 0.5s ease;
        }
        
        .literary-works ul {
            list-style-type: none;
            padding: 0;
        }
        
        .literary-works li {
            padding: 0.8rem;
            margin: 0.5rem 0;
            background: rgba(74, 108, 247, 0.05);
            border-left: 3px solid var(--primary-color);
            transition: all 0.3s;
        }
        
        .literary-works li:hover {
            background: rgba(74, 108, 247, 0.1);
            transform: translateX(5px);
        }
        
        .counter {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            background: var(--primary-color);
            color: white;
            font-weight: 500;
        }
        
        .counter-number {
            font-size: 1.8rem;
            font-weight: bold;
            margin: 0 0.5rem;
            color: rgb(15, 26, 78);
        }
        
        .search-container {
            max-width: 800px;
            margin: -2rem auto 2rem;
            position: relative;
            z-index: 10;
            padding: 0 1rem;
        }
        
        #searchInput {
            width: 100%;
            padding: 1rem 1.5rem;
            border: none;
            border-radius: 50px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            font-size: 1.1rem;
            transition: all 0.3s;
            background: white url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="%23718096" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>') no-repeat 1.5rem center;
            padding-left: 3.5rem;
        }
        
        #searchInput:focus {
            outline: none;
            box-shadow: 0 5px 20px rgba(42, 143, 230, 0.3);
            transform: translateY(-2px);
        }
        
        #searchBtn {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            padding: 0 1.5rem;
            border: none;
            background: var(--primary-color);
            color: white;
            border-radius: 0 50px 50px 0;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        #searchBtn:hover {
            background: var(--secondary-color);
        }
        
        /* æ–°å¢ï¼šä¾§è¾¹æ»šåŠ¨é¢æ¿æ ·å¼ */
        .side-panel {
            position: fixed;
            top: 0;
            bottom: 0;
            width: var(--side-panel-width);
            background: var(--side-panel-bg);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            z-index: 100;
            overflow-y: auto;
            transition: transform 0.4s ease;
            backdrop-filter: blur(5px);
            border-radius: 0 12px 12px 0;
        }
        
        .left-panel {
            left: 0;
            transform: translateX(-100%);
        }
        
        .right-panel {
            right: 0;
            transform: translateX(100%);
        }
        
        .side-panel.visible {
            transform: translateX(0);
        }
        
        .panel-toggle {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            background: var(--primary-color);
            color: white;
            width: 40px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border-radius: 0 8px 8px 0;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            z-index: 99;
            transition: all 0.3s ease;
        }
        
        .panel-toggle:hover {
            background: var(--secondary-color);
            width: 45px;
        }
        
        .left-toggle {
            left: 0;
        }
        
        .right-toggle {
            right: 0;
            border-radius: 8px 0 0 8px;
        }
        
        .panel-header {
            font-family: 'Noto Serif SC', serif;
            font-size: 1.5rem;
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--accent-color);
        }
        
        .timeline-item {
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px dashed #e2e8f0;
        }
        
        .timeline-year {
            font-weight: bold;
            color: var(--secondary-color);
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }
        
        .timeline-content {
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        .author-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .author-card {
            background: rgba(42, 143, 230, 0.08);
            border-radius: 8px;
            padding: 0.8rem;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .author-card:hover {
            background: rgba(42, 143, 230, 0.15);
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .author-name {
            font-weight: 500;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }
        
        .quote {
            font-style: italic;
            padding: 1rem;
            border-left: 3px solid var(--accent-color);
            background: rgba(255, 107, 107, 0.05);
            margin: 1.5rem 0;
            border-radius: 0 6px 6px 0;
        }
        
        .quote-author {
            text-align: right;
            font-size: 0.9rem;
            color: var(--light-text);
            margin-top: 0.5rem;
        }
        
        .recommended-book {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .book-cover {
            flex: 0 0 60px;
            height: 80px;
            background: var(--secondary-color);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.8rem;
            text-align: center;
            padding: 0.5rem;
            line-height: 1.3;
        }
        
        .book-info {
            flex: 1;
        }
        
        .book-title {
            font-weight: bold;
            margin-bottom: 0.3rem;
        }
        
        .book-author {
            font-size: 0.85rem;
            color: var(--light-text);
            margin-bottom: 0.5rem;
        }
        
        .book-desc {
            font-size: 0.85rem;
            line-height: 1.5;
        }
        
        @media (max-width: 1200px) {
            .side-panel {
                width: 240px;
            }
        }
        
        @media (max-width: 992px) {
            .side-panel {
                width: 220px;
                padding: 1rem;
            }
            
            .panel-header {
                font-size: 1.3rem;
            }
        }
        
        @media (max-width: 768px) {
            .side-panel {
                width: 85%;
                border-radius: 0;
            }
            
            .left-panel {
                transform: translateX(-100%);
            }
            
            .right-panel {
                transform: translateX(100%);
            }
            
            .panel-toggle {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- å·¦ä¾§ä¿¡æ¯é¢æ¿ -->
    <div class="side-panel left-panel" id="leftPanel">
        <div class="panel-header">å—äº¬æ–‡å­¦æ—¶é—´è½´</div>
        
        <div class="timeline-item">
            <div class="timeline-year">1920-1930</div>
            <div class="timeline-content">
                <p>å—äº¬æˆä¸ºæ–°æ–‡åŒ–è¿åŠ¨çš„é‡è¦é˜µåœ°ï¼Œæœ±è‡ªæ¸…ã€ä¿å¹³ä¼¯ç­‰ä½œå®¶åœ¨å—äº¬åˆ›ä½œäº†å¤§é‡ä½œå“ã€‚</p>
                <p>1923å¹´ï¼Œæœ±è‡ªæ¸…åœ¨å—äº¬åˆ›ä½œäº†è‘—åæ•£æ–‡ã€Šæ¡¨å£°ç¯å½±é‡Œçš„ç§¦æ·®æ²³ã€‹ã€‚</p>
            </div>
        </div>
        
        <div class="timeline-item">
            <div class="timeline-year">1930-1940</div>
            <div class="timeline-content">
                <p>å—äº¬ä½œä¸ºæ°‘å›½é¦–éƒ½ï¼Œæ–‡å­¦åˆ›ä½œç¹è£ï¼Œæ¶Œç°å‡ºå¼ æ¨æ°´ã€å·´é‡‘ç­‰ä½œå®¶ã€‚</p>
                <p>1934å¹´ï¼Œå¼ æ¨æ°´å¼€å§‹åœ¨å—äº¬åˆ›ä½œã€Šé‡‘ç²‰ä¸–å®¶ã€‹ã€‚</p>
            </div>
        </div>
        
        <div class="timeline-item">
            <div class="timeline-year">1950-1960</div>
            <div class="timeline-content">
                <p>æ–°ä¸­å›½æˆç«‹åï¼Œå—äº¬æ–‡å­¦è¿›å…¥æ–°çš„å‘å±•é˜¶æ®µï¼Œé™†æ–‡å¤«ã€é«˜æ™“å£°ç­‰ä½œå®¶æ´»è·ƒã€‚</p>
                <p>1957å¹´ï¼Œé™†æ–‡å¤«å‘è¡¨çŸ­ç¯‡å°è¯´ã€Šå°å··æ·±å¤„ã€‹ï¼Œæå†™å—äº¬å°å¸‚æ°‘ç”Ÿæ´»ã€‚</p>
            </div>
        </div>
        
        <div class="timeline-item">
            <div class="timeline-year">1980è‡³ä»Š</div>
            <div class="timeline-content">
                <p>æ–°æ—¶æœŸå—äº¬æ–‡å­¦ç¹è£ï¼Œå¶å…†è¨€ã€è‹ç«¥ã€æ¯•é£å®‡ç­‰ä½œå®¶å´›èµ·ã€‚</p>
                <p>å¶å…†è¨€åˆ›ä½œäº†ã€Šå—äº¬äººã€‹ã€Šå—äº¬ä¼ ã€‹ç­‰å—äº¬é¢˜æä½œå“ã€‚</p>
            </div>
        </div>
        
        <div class="panel-header" style="margin-top: 2rem;">å—äº¬ä½œå®¶ç¾¤</div>
        <div class="author-list">
            <div class="author-card" data-author="æœ±è‡ªæ¸…">
                <div class="author-name">æœ±è‡ªæ¸…</div>
            </div>
            <div class="author-card" data-author="ä¿å¹³ä¼¯">
                <div class="author-name">ä¿å¹³ä¼¯</div>
            </div>
            <div class="author-card" data-author="å¼ æ¨æ°´">
                <div class="author-name">å¼ æ¨æ°´</div>
            </div>
            <div class="author-card" data-author="å·´é‡‘">
                <div class="author-name">å·´é‡‘</div>
            </div>
            <div class="author-card" data-author="å¶å…†è¨€">
                <div class="author-name">å¶å…†è¨€</div>
            </div>
            <div class="author-card" data-author="è‹ç«¥">
                <div class="author-name">è‹ç«¥</div>
            </div>
            <div class="author-card" data-author="æ¯•é£å®‡">
                <div class="author-name">æ¯•é£å®‡</div>
            </div>
            <div class="author-card" data-author="é™†æ–‡å¤«">
                <div class="author-name">é™†æ–‡å¤«</div>
            </div>
        </div>
        
        <div class="quote">
            "é€›å—äº¬åƒé€›å¤è‘£é“ºå­ï¼Œåˆ°å¤„éƒ½æœ‰äº›æ—¶ä»£ä¾µèš€çš„é—ç—•ã€‚ä½ å¯ä»¥æ‘©æŒ²ï¼Œå¯ä»¥å‡­åŠï¼Œå¯ä»¥æ‚ ç„¶éæƒ³..."
            <div class="quote-author">â€”â€” æœ±è‡ªæ¸…ã€Šå—äº¬ã€‹</div>
        </div>
    </div>
    
    <!-- å³ä¾§ä¿¡æ¯é¢æ¿ -->
    <div class="side-panel right-panel" id="rightPanel">
        <div class="panel-header">æ–‡å­¦åœ°æ ‡å¯¼è§ˆ</div>
        
        <div class="recommended-book">
            <div class="book-cover">ç§¦æ·®æ²³</div>
            <div class="book-info">
                <div class="book-title">æ¡¨å£°ç¯å½±é‡Œçš„ç§¦æ·®æ²³</div>
                <div class="book-author">æœ±è‡ªæ¸…</div>
                <div class="book-desc">æœ±è‡ªæ¸…ä¸ä¿å¹³ä¼¯åŒæ¸¸ç§¦æ·®æ²³åå„è‡ªåˆ›ä½œçš„æ•£æ–‡åç¯‡ï¼Œæå†™äº†ç§¦æ·®æ²³å¤œæ™¯å’Œäººæ–‡é£æƒ…ã€‚</div>
            </div>
        </div>
        
        <div class="recommended-book">
            <div class="book-cover">å¤«å­åº™</div>
            <div class="book-info">
                <div class="book-title">å—äº¬äºº</div>
                <div class="book-author">å¶å…†è¨€</div>
                <div class="book-desc">å¶å…†è¨€ç¬”ä¸‹å—äº¬äººçš„ç”Ÿæ´»ç™¾æ€ï¼Œå¤«å­åº™çš„å¸‚äº•æ°”æ¯åœ¨ä¹¦ä¸­å¾—åˆ°ç”ŸåŠ¨å±•ç°ã€‚</div>
            </div>
        </div>
        
        <div class="recommended-book">
            <div class="book-cover">ä¸­å±±é™µ</div>
            <div class="book-info">
                <div class="book-title">é’Ÿå±±é£é›¨</div>
                <div class="book-author">å¼ æ¨æ°´</div>
                <div class="book-desc">ä»¥å—äº¬ä¸ºèƒŒæ™¯çš„é•¿ç¯‡å°è¯´ï¼Œæç»˜äº†æ°‘å›½æ—¶æœŸå—äº¬çš„ç¤¾ä¼šå˜è¿ã€‚</div>
            </div>
        </div>
        
        <div class="panel-header" style="margin-top: 1.5rem;">æ–‡å­¦å°è´´å£«</div>
        <div class="timeline-content">
            <p><strong>å—äº¬æ–‡å­¦åœ°å›¾ä½¿ç”¨æŒ‡å—ï¼š</strong></p>
            <ul>
                <li>ç‚¹å‡»åœ°å›¾ä¸Šçš„æ ‡è®°ç‚¹æŸ¥çœ‹è¯¦æƒ…</li>
                <li>æœç´¢æ¡†å¯æŸ¥æ‰¾ä½œå®¶åŠä½œå“</li>
                <li>ä½œå®¶å¡ç‰‡å¯å¿«é€Ÿå®šä½ç›¸å…³åœ°ç‚¹</li>
                <li>ä½¿ç”¨æ—¶é—´è½´äº†è§£æ–‡å­¦å‘å±•è„‰ç»œ</li>
            </ul>
        </div>
        
        <div class="quote">
            "å—äº¬çš„å¯çˆ±ï¼Œåœ¨æ–‡å­¦ä¸­è¡¨ç°å¾—æœ€ä¸ºå……åˆ†ã€‚å…­æœå¤éƒ½çš„æ²§æ¡‘ï¼Œç§¦æ·®æ²³çš„é£æœˆï¼Œç„æ­¦æ¹–çš„çƒŸæ³¢ï¼Œéƒ½åœ¨ä½œå®¶ç¬”ä¸‹å¾—åˆ°äº†æ°¸ç”Ÿã€‚"
            <div class="quote-author">â€”â€” å¶å…†è¨€</div>
        </div>
    </div>
    
    <!-- é¢æ¿åˆ‡æ¢æŒ‰é’® -->
    <div class="panel-toggle left-toggle" id="leftToggle">æ–‡</div>
    <div class="panel-toggle right-toggle" id="rightToggle">å­¦</div>

    <div class="header">
        <h1>æ¢ç´¢ä½œå®¶ç¬”ä¸‹çš„äººæ–‡å—äº¬</h1>
        <p>æ–‡éƒ½äº‘å›¾ï¼šå—äº¬ç°å½“ä»£æ–‡å­¦åœ°å›¾æ•°å­—å¯¼è§ˆä¸æ–‡åˆ›å¹³å°</p>
    </div>
    
    <div class="search-container">
        <input type="text" id="searchInput" placeholder="è¯·è¾“å…¥ä½œå®¶å§“å(å¦‚:å¶å…†è¨€ã€æœ±è‡ªæ¸…...)">
        <button id="searchBtn">æœç´¢</button>
    </div>
    
    <div class="container">
        <div id="mapContainer"></div>
        
        <div class="sidebar">
            <div id="infoPanel">
                <div class="default-message">
                    <h3>æ¬¢è¿ä½¿ç”¨å—äº¬ç°å½“ä»£æ–‡å­¦åœ°å›¾æ•°å­—å¯¼è§ˆä¸æ–‡åˆ›å¹³å°</h3>
                    <p>åœ¨æœç´¢æ¡†ä¸­è¾“å…¥ä½œå®¶å§“åï¼ŒæŸ¥çœ‹ä»–ä»¬åœ¨å—äº¬çš„åˆ›ä½œè¶³è¿¹</p>
                    <p>ç‚¹å‡»åœ°å›¾ä¸Šçš„æ ‡è®°ç‚¹ï¼ŒæŸ¥çœ‹ä½œå“è¯¦æƒ…</p>
                    <p>ä½¿ç”¨ä¸¤ä¾§é¢æ¿äº†è§£æ›´å¤šå—äº¬æ–‡å­¦ä¿¡æ¯</p>
                </div>
            </div>
            
            <div id="counter">
                <div class="counter-label">å½“å‰å±•ç¤º</div>
                <div class="counter-number">0</div>
                <div class="counter-label">ä¸ªç›¸å…³åœ°æ ‡</div>
            </div>
        </div>
    </div>
    
    <!-- AIåŠ©æ‰‹å®¹å™¨ä¿æŒä¸å˜ -->
    <div id="ai-assistant">
        <div id="chat-container">
            <div class="chat-header">
                <h3>å—äº¬æ–‡å­¦åŠ©æ‰‹</h3>
                <button id="close-chat">Ã—</button>
            </div>
            <!-- è™šæ‹Ÿå½¢è±¡åŒºåŸŸ -->
            <div id="avatar-container">
                <div id="avatar-animation"></div>
            </div>
            <div id="chat-messages"></div>
            <div class="chat-input">
                <input type="text" id="user-input" placeholder="è¾“å…¥å…³äºå—äº¬ç°å½“ä»£æ–‡å­¦çš„é—®é¢˜...">
                <button id="send-btn">å‘é€</button>
            </div>
        </div>
        <button id="chat-toggle">ğŸ’¬ğŸ’¬</button>
    </div>

    <div class="explore-btn-container">
        <a href="./html/product.html" class="explore-btn">
            æ–‡åˆ›äº§å“
        </a>
    </div>
    
    <script src="./js/script.js"></script>
    <script src="./js/ai_assistant.js"></script> 
    
    <script>
        // é¢æ¿åˆ‡æ¢åŠŸèƒ½
        document.getElementById('leftToggle').addEventListener('click', function() {
            document.getElementById('leftPanel').classList.toggle('visible');
        });
        
        document.getElementById('rightToggle').addEventListener('click', function() {
            document.getElementById('rightPanel').classList.toggle('visible');
        });
        
        // ç‚¹å‡»ä½œå®¶å¡ç‰‡æ—¶è‡ªåŠ¨æœç´¢
        document.querySelectorAll('.author-card').forEach(card => {
            card.addEventListener('click', function() {
                const author = this.getAttribute('data-author');
                document.getElementById('searchInput').value = author;
                document.getElementById('searchBtn').click();
                
                // ç¡®ä¿å·¦ä¾§é¢æ¿æ‰“å¼€
                document.getElementById('leftPanel').classList.add('visible');
            });
        });
    
        // åœ°å›¾åˆå§‹åŒ–ä»£ç 
        $(document).ready(function() {
            const myChart = echarts.init(document.getElementById('mapContainer'));
        
        // ä½¿ç”¨å…¨å±€å‡½æ•°è·å–æ ‡è®°ç‚¹æ•°æ®
        const allMarkers = window.getNanjingMarkers();
            // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
            myChart.showLoading({
        text: 'æ­£åœ¨åŠ è½½æ–‡å­¦åœ°å›¾...',
        color: '#4a6cf7',
        textColor: '#4a5568',
        maskColor: 'rgba(255, 255, 255, 0.95)',
        spinnerRadius: 15,
        lineWidth: 4,
        fontSize: 16,
        fontWeight: 'bold'
    });
    function showCustomLoading() {
        $('#mapContainer').append(`
            <div class="custom-loading">
                <div class="loading-spinner">
                    <div class="double-bounce1"></div>
                    <div class="double-bounce2"></div>
                </div>
                <div class="loading-text">æ¢ç´¢å—äº¬æ–‡å­¦ä¸–ç•Œ...</div>
            </div>
        `);
    }
    
    function hideCustomLoading() {
        $('.custom-loading').fadeOut(300, function() {
            $(this).remove();
        });
    }
            // ä½¿ç”¨æœ¬åœ°åœ°å›¾æ•°æ®
            fetch('./data/nanjing.json')
                .then(response => response.json())
                .then(nanjingGeoJSON => {
                    echarts.registerMap('nanjing', nanjingGeoJSON);
                    
                    const allMarkers = window.getNanjingMarkers();
                    
                    const option = {
                        title: {
                            text: 'å—äº¬æ–‡å­¦åœ°å›¾',
                            subtext: 'ä½œå®¶ç¬”ä¸‹çš„äººæ–‡å—äº¬',
                            left: 'center',
                            textStyle: { 
                                color: '#2d3748', 
                                fontSize: 24,
                                fontWeight: 'bold'
                            },
                            subtextStyle: { 
                                color: '#718096',
                                fontSize: 16
                            }
                        },
                        tooltip: {
                            trigger: 'item',
                            backgroundColor: 'rgba(255, 255, 255, 0.95)',
                            borderColor: '#e2e8f0',
                            borderWidth: 1,
                            padding: 15,
                            borderRadius: 8,
                            textStyle: {
                                color: '#2d3748'
                            },
                            formatter: function(params) {
                                if (params.componentType === 'series') {
                                    return `<div style="font-weight:bold;margin-bottom:5px;">${params.name}</div>
                                            <div>${params.data.excerpt || 'å—äº¬æ–‡å­¦åœ°æ ‡'}</div>
                                            <div style="margin-top:8px;color:#4a5568;">ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…</div>`;
                                }
                                return params.name;
                            }
                        },
                        geo: {
                            map: 'nanjing',
                            roam: true,
                            zoom: 8,
                            center: [118.8, 32.05],
                            label: { 
                                emphasis: { 
                                    show: false 
                                } 
                            },
                            itemStyle: {
                                areaColor: '#e8f4ff',
                                borderColor: '#297acc'
                            },
                            emphasis: {
                                itemStyle: { 
                                    areaColor: '#a4d0ff' 
                                },
                                label: { 
                                    show: true, 
                                    color: '#1a3d66' 
                                }
                            }
                        },
                        series: [{
                            name: 'æ–‡å­¦åœ°æ ‡',
                            type: 'scatter',
                            coordinateSystem: 'geo',
                            symbol: 'pin',
                            symbolSize: [40, 50],
                            itemStyle: { 
                                color: '#ff6b6b' 
                            },
                            data: allMarkers,
                            label: {
                                show: true,
                                formatter: '{b}',
                                position: 'bottom',
                                color: '#1a3d66',
                                fontSize: 12
                            },
                            zlevel: 2
                        }]
                    };
                    
                    // åº”ç”¨é…ç½®
                    myChart.setOption(option);
                    
                    // éšè—åŠ è½½åŠ¨ç”»
                    myChart.hideLoading();
                    
                    // æ›´æ–°è®¡æ•°å™¨
                    $('.counter-number').text(allMarkers.length);
                    
                    // åœ°å›¾ç‚¹å‡»äº‹ä»¶
                    myChart.on('click', function(params) {
    if (params.componentType === 'series') {
        const location = params.data;
        
        let worksHtml = '';
        if (location.works && location.works.length > 0) {
            worksHtml = '<div class="literary-works"><h4>ç›¸å…³ä½œå“:</h4><ul>';
            
            location.works.forEach(work => {
                const title = work.title || "æœªçŸ¥ä½œå“";
                const author = work.author || "æœªçŸ¥ä½œè€…";
                const excerpt = work.excerpt || "æš‚æ— æè¿°";
                const nanjingDesc = work.nanjingDescription || "æš‚æ— å—äº¬ç›¸å…³æå†™";
                const locationName = work.location || "æœªçŸ¥åœ°ç‚¹";
                
                worksHtml += `
                    <li class="work-item">
                        <div class="work-header">
                            <span class="work-title">ã€Š${title}ã€‹</span>
                            <span class="work-location">- ${locationName}</span>
                        </div>
                        <div class="work-author">ä½œè€…ï¼š${author}</div>
                        <div class="work-excerpt">${excerpt}</div>
                        <div class="nanjing-description">
                            <div class="desc-title">å—äº¬æå†™ï¼š</div>
                            <div class="desc-content">${nanjingDesc}</div>
                        </div>
                    </li>
                `;
            });
            
            worksHtml += '</ul></div>';
        } else {
            worksHtml = '<p class="no-works">æš‚æ— ç›¸å…³ä½œå“ä¿¡æ¯</p>';
        }
        
        $('#infoPanel').html(`
            <div class="location-info">
                <h3>${location.name || "æœªçŸ¥åœ°ç‚¹"}</h3>
                <p class="location-description">${location.excerpt || "æ±Ÿè‹çœä¼šï¼Œå…­æœå¤éƒ½ï¼Œä¸­å›½ç°ä»£æ–‡å­¦é‡è¦åŸå¸‚"}</p>
                ${worksHtml}
            </div>
        `);
    }
});
});
            // å“åº”çª—å£å¤§å°å˜åŒ–
            window.addEventListener('resize', function() {
                myChart.resize();
            });
            
            // æœç´¢æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            $('#searchBtn').click(function() {
                const query = $('#searchInput').val().trim().toLowerCase();
                const exactMatch = Object.keys(authorsData).find(author => 
        author.toLowerCase() === query
    );
                // å…ˆå–æ¶ˆä¹‹å‰æ‰€æœ‰é«˜äº®
                myChart.dispatchAction({ type: 'downplay' });
                
                // è¿‡æ»¤å‡ºåŒ…å«è¯¥ä½œè€…çš„åœ°æ ‡ç‚¹
                const filteredMarkers = allMarkers.filter(marker => 
                    marker.authors && marker.authors.some(author => author.includes(query))
                );
                
                if (filteredMarkers.length > 0) {
                    // æ›´æ–°åœ°å›¾æ•°æ® - åªæ˜¾ç¤ºè¯¥ä½œå®¶ç›¸å…³çš„æ ‡è®°ç‚¹
                    myChart.setOption({
                        series: [{
                            data: filteredMarkers
                        }]
                    });
                    
                    // æ›´æ–°è®¡æ•°å™¨
                    $('.counter-number').text(filteredMarkers.length);
                    
                    // é«˜äº®ç›¸å…³åŒºåŸŸ
                    filteredMarkers.forEach(marker => {
                        myChart.dispatchAction({
                            type: 'highlight',
                            seriesIndex: 0,
                            name: marker.name
                        });
                    });
                    
                    // æŸ¥æ‰¾ä½œå®¶ä¿¡æ¯
                    const matchedAuthor = Object.keys(authorsData).find(author => 
            author.includes(query) || query.includes(author)
                    );
                    
                     if (matchedAuthor) {
            const authorInfo = authorsData[matchedAuthor];
            // æ„å»ºä½œå“åˆ—è¡¨ï¼ˆå®Œæ•´ä»£ç ï¼‰
            let worksHtml = '';
            if (authorInfo.works && authorInfo.works.length > 0) {
                worksHtml = '<div class="literary-works"><h4>ä»£è¡¨ä½œå“:</h4><ul>';
                authorInfo.works.forEach(work => {
                    // ç¡®ä¿æ˜¾ç¤ºä½œå“æè¿°
                    worksHtml += `<li>
                        <div class="work-title">ã€Š${work.title}ã€‹</div>
                        <div class="work-location">åœ°ç‚¹: ${work.location}</div>
                        <div class="work-excerpt">${work.excerpt}</div>
                        <div class="nanjing-description">${work.nanjingDescription || 'æš‚æ— å—äº¬ç›¸å…³æå†™'}</div>
                    </li>`;
                });
                worksHtml += '</ul></div>';
            }
            
            $('#infoPanel').html(`
                <div class="author-info">
                    <h3>${authorInfo.name}</h3>
                    <p>${authorInfo.intro}</p>
                    ${worksHtml}
                </div>
            `);
        }
    } else {
                    $('#infoPanel').html(`<div class="author-info">
                        <h3>æœªæ‰¾åˆ°ç›¸å…³ç»“æœ</h3>
                        <p>è¯·å°è¯•æœç´¢ä½œå®¶å§“å(å¦‚:å¶å…†è¨€ã€æœ±è‡ªæ¸…)æˆ–åœ°ç‚¹åç§°(å¦‚:ç§¦æ·®æ²³ã€å¤«å­åº™)</p>
                    </div>`);
                    
                    myChart.setOption({
                        series: [{
                            data: allMarkers
                        }]
                    });
                    $('.counter-number').text(allMarkers.length);
                }
            });
        });
    </script>
</body>
</html>
